!! Building configuration
!! IOS XR Configuration 24.3.2
!! Last configuration change at Tue Mar 25 04:12:41 2025 by admin
!
hostname CPE1
banner motd %
*********************************************************
*                                                       *
*                   NaaS VirtualLab                     *
*                                                       *
*********************************************************
%
username admin
 group root-lr
 group cisco-support
 secret 10 $6$QV8uZ1cWStcLCZ1.$/Szlc2yABk1hQI82c8cfWfwd.sZU30WwtjP.EWJyNSG.NtpP.323/468m4fi5KFsmH2zRWYY.gArKk/n95T9K/
!
address-family ipv6 unicast
!
interface Loopback0
 ipv6 address fcdd:dd00:301::1/128
!
interface Loopback1111
 ipv6 address 2222:1111:1111::1/56
!
interface Loopback2111
 ipv6 address 2222:1111:2111::1/56
!
interface MgmtEth0/RP0/CPU0/0
 ipv4 address 172.16.255.9 255.255.255.192
!
interface GigabitEthernet0/0/0/0
 lldp
  enable
 !
!
interface GigabitEthernet0/0/0/0.11
 description to OLT
 ipv6 address 2002:300:33::2/127
 ipv6 enable
 encapsulation dot1q 11
!
prefix-set naas-cpe-locator
  fcdd:dd00:301::/48
end-set
!
prefix-set legal-ipv6-prefix
  2222::/16 ge 16,
  2002::/16 ge 16,
  2001::/16 ge 16
end-set
!
route-policy test
end-policy
!
route-policy pass-all
  pass
end-policy
!
route-policy pass-all-in
  pass
end-policy
!
route-policy pass-all-out
  if destination in legal-ipv6-prefix then
    pass
  endif
  if destination in (fcdd:dd00:301::/48) then
    pass
  endif
end-policy
!
route-policy combined-policy
  if destination in naas-cpe-locator then
    delete prefix-sid 
  else
    pass
  endif
end-policy
!
route-policy naas-cpe-locator
  if destination in naas-cpe-locator then
    pass
  else
    drop
  endif
end-policy
!
router static
 address-family ipv6 unicast
  fcdd:dd00:3e0::/44 2002:300:33::3
 !
!
router bgp 111
 bgp router-id 1.1.1.1
 bgp update-delay 5
 nexthop resolution allow-default
 address-family ipv6 unicast
  maximum-paths eibgp 8
  additional-paths receive
  additional-paths send
  segment-routing srv6
   locator Locator0
  !
  network 2222:1111:1111::/56
  network 2222:1111:2111::/56
 !
 neighbor 2002:300:33::3
  remote-as 64577
  shutdown
  description ebgp to AL1
  address-family ipv6 unicast
   route-policy naas-cpe-locator out
   soft-reconfiguration inbound always
  !
 !
 neighbor fcdd:dd00:3ee::1
  remote-as 64577
  bfd fast-detect
  bfd multiplier 3
  bfd minimum-interval 300
  ebgp-multihop 5
  password encrypted 011101144B0E031D
  update-source GigabitEthernet0/0/0/0.11
  address-family ipv6 unicast
   route-policy pass-all in
   encapsulation-type srv6
   route-policy pass-all out
   soft-reconfiguration inbound always
  !
 !
!
segment-routing
 srv6
  locators
   locator Locator0
    micro-segment behavior unode psp-usd
    prefix fcdd:dd00:301::/48
   !
  !
 !
!
ssh server v2
ssh server netconf vrf default
end
